ARM GAS  C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"max6650.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.get_scale,"ax",%progbits
  18              		.align	1
  19              		.arch armv7e-m
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	get_scale:
  26              	.LVL0:
  27              	.LFB3:
  28              		.file 1 "../libs/max6650/src/max6650.c"
   1:../libs/max6650/src/max6650.c **** /*
   2:../libs/max6650/src/max6650.c ****  Set the fan speed to the specified RPM (or read back the RPM setting).
   3:../libs/max6650/src/max6650.c **** 
   4:../libs/max6650/src/max6650.c ****  The MAX6650/1 will automatically control fan speed when in closed loop
   5:../libs/max6650/src/max6650.c ****  mode.
   6:../libs/max6650/src/max6650.c **** 
   7:../libs/max6650/src/max6650.c ****  Assumptions:
   8:../libs/max6650/src/max6650.c **** 
   9:../libs/max6650/src/max6650.c ****  1) The MAX6650/1 is running from its internal 254kHz clock (perhaps
  10:../libs/max6650/src/max6650.c ****     this should be made a module parameter).
  11:../libs/max6650/src/max6650.c **** 
  12:../libs/max6650/src/max6650.c ****  2) The prescaler (low three bits of the config register) has already
  13:../libs/max6650/src/max6650.c ****     been set to an appropriate value.
  14:../libs/max6650/src/max6650.c **** 
  15:../libs/max6650/src/max6650.c ****  The relevant equations are given on pages 21 and 22 of the datasheet.
  16:../libs/max6650/src/max6650.c **** 
  17:../libs/max6650/src/max6650.c ****  From the datasheet, the relevant equation when in regulation is:
  18:../libs/max6650/src/max6650.c **** 
  19:../libs/max6650/src/max6650.c ****     [fCLK / (128 x (KTACH + 1))] = 2 x FanSpeed / KSCALE
  20:../libs/max6650/src/max6650.c **** 
  21:../libs/max6650/src/max6650.c ****  where:
  22:../libs/max6650/src/max6650.c **** 
  23:../libs/max6650/src/max6650.c ****     fCLK is the oscillator frequency (either the 254kHz internal
  24:../libs/max6650/src/max6650.c ****          oscillator or the externally applied clock)
  25:../libs/max6650/src/max6650.c **** 
  26:../libs/max6650/src/max6650.c ****     KTACH is the value in the speed register
  27:../libs/max6650/src/max6650.c **** 
  28:../libs/max6650/src/max6650.c ****     FanSpeed is the speed of the fan in rps
  29:../libs/max6650/src/max6650.c **** 
  30:../libs/max6650/src/max6650.c ****     KSCALE is the prescaler value (1, 2, 4, 8, or 16)
ARM GAS  C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s 			page 2


  31:../libs/max6650/src/max6650.c **** 
  32:../libs/max6650/src/max6650.c ****  When reading, we need to solve for FanSpeed :
  33:../libs/max6650/src/max6650.c **** 
  34:../libs/max6650/src/max6650.c ****       FanSpeed = (tacho / 2) x count_t
  35:../libs/max6650/src/max6650.c **** 
  36:../libs/max6650/src/max6650.c ****       then multiply by 60 to give fanspeed in rpm
  37:../libs/max6650/src/max6650.c **** 
  38:../libs/max6650/src/max6650.c ****  When writing, we need to solve for KTACH, using the datasheet equation:
  39:../libs/max6650/src/max6650.c **** 
  40:../libs/max6650/src/max6650.c ****     Divide the required speed by 60 to get from rpm to rps
  41:../libs/max6650/src/max6650.c **** 
  42:../libs/max6650/src/max6650.c ****       KTACH = [(fCLK x KSCALE) / (256 x FanSpeed)] - 1
  43:../libs/max6650/src/max6650.c **** 
  44:../libs/max6650/src/max6650.c ****     If the internal oscillator is used, setting fCLK to 254kHz
  45:../libs/max6650/src/max6650.c ****     can further reduce the equations:
  46:../libs/max6650/src/max6650.c **** 
  47:../libs/max6650/src/max6650.c ****       Divide the required speed by 60 to get from rpm to rps
  48:../libs/max6650/src/max6650.c **** 
  49:../libs/max6650/src/max6650.c ****       KTACH = (992 x KSCALE / FanSpeed) - 1
  50:../libs/max6650/src/max6650.c **** 
  51:../libs/max6650/src/max6650.c ****  Note: this tachometer is completely separate from the tachometers
  52:../libs/max6650/src/max6650.c ****  used to measure the fan speeds. Only one fan's speed (fan1) is
  53:../libs/max6650/src/max6650.c ****  controlled.
  54:../libs/max6650/src/max6650.c **** */
  55:../libs/max6650/src/max6650.c **** 
  56:../libs/max6650/src/max6650.c **** #include <stdio.h>
  57:../libs/max6650/src/max6650.c **** #include "max6650.h"
  58:../libs/max6650/src/max6650.c **** 
  59:../libs/max6650/src/max6650.c **** #define MAX6650_SPEED_REG               0b00000000     /* fan speed R/W */
  60:../libs/max6650/src/max6650.c **** #define MAX6650_CONFIG_REG              0b00000010     /* configuration R/W */
  61:../libs/max6650/src/max6650.c **** #define MAX6650_GPIODEF_REG             0b00000100     /* GPIO definition R/W */
  62:../libs/max6650/src/max6650.c **** #define MAX6650_DAC_REG                 0b00000110     /* DAC R/W */
  63:../libs/max6650/src/max6650.c **** #define MAX6650_ALARMENABLE_REG         0b00001000     /* alarm enable R/W */
  64:../libs/max6650/src/max6650.c **** #define MAX6650_ALARM_REG               0b00001010     /* alarm status R */
  65:../libs/max6650/src/max6650.c **** #define MAX6650_TACHO_0_REG             0b00001100     /* tachometer 0 count R */
  66:../libs/max6650/src/max6650.c **** #define MAX6650_GPIOSTAT_REG            0b00010100     /* GPIO status R */
  67:../libs/max6650/src/max6650.c **** #define MAX6650_COUNT_REG               0b00010110     /* tachometer count time R/W */
  68:../libs/max6650/src/max6650.c **** 
  69:../libs/max6650/src/max6650.c **** #define I2C_ADDRESS_GND                 0x90
  70:../libs/max6650/src/max6650.c **** #define I2C_ADDRESS_VCC                 0x96
  71:../libs/max6650/src/max6650.c **** #define I2C_ADDRESS_NOT_CONNECTED       0x36
  72:../libs/max6650/src/max6650.c **** #define I2C_ADDRESS_RES10K              0x3E
  73:../libs/max6650/src/max6650.c **** 
  74:../libs/max6650/src/max6650.c **** #define COUNTT                          2               /* default count time */
  75:../libs/max6650/src/max6650.c **** 
  76:../libs/max6650/src/max6650.c **** static const struct MAX6650_I2C_ExtInterface *i2c_ext_if = NULL;
  77:../libs/max6650/src/max6650.c **** static MAX6650_Config_t *config = NULL;
  78:../libs/max6650/src/max6650.c **** static uint8_t i2c_address;
  79:../libs/max6650/src/max6650.c **** 
  80:../libs/max6650/src/max6650.c **** 
  81:../libs/max6650/src/max6650.c **** static uint8_t get_scale(MAX6650_KScale_t k_scale)
  82:../libs/max6650/src/max6650.c **** {
  29              		.loc 1 82 1 view -0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33              		@ link register save eliminated.
ARM GAS  C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s 			page 3


  83:../libs/max6650/src/max6650.c ****     uint res = KScale_4;
  34              		.loc 1 83 5 view .LVU1
  84:../libs/max6650/src/max6650.c ****     switch(k_scale)
  35              		.loc 1 84 5 view .LVU2
  36 0000 0428     		cmp	r0, #4
  37 0002 04D8     		bhi	.L2
  38 0004 DFE800F0 		tbb	[pc, r0]
  39              	.L4:
  40 0008 0B       		.byte	(.L8-.L4)/2
  41 0009 03       		.byte	(.L2-.L4)/2
  42 000a 05       		.byte	(.L6-.L4)/2
  43 000b 07       		.byte	(.L5-.L4)/2
  44 000c 09       		.byte	(.L3-.L4)/2
  45 000d 00       		.p2align 1
  46              	.L2:
  47 000e 0220     		movs	r0, #2
  48              	.LVL1:
  49              		.loc 1 84 5 is_stmt 0 view .LVU3
  50 0010 7047     		bx	lr
  51              	.LVL2:
  52              	.L6:
  85:../libs/max6650/src/max6650.c ****     {
  86:../libs/max6650/src/max6650.c ****         case KScale_1: res = 1; break;
  87:../libs/max6650/src/max6650.c ****         case KScale_2: res = 2; break;
  88:../libs/max6650/src/max6650.c ****         case KScale_4: res = 4; break;
  53              		.loc 1 88 24 is_stmt 1 view .LVU4
  54              		.loc 1 88 33 view .LVU5
  55              		.loc 1 88 28 is_stmt 0 view .LVU6
  56 0012 0420     		movs	r0, #4
  57              	.LVL3:
  58              		.loc 1 88 9 view .LVU7
  59 0014 7047     		bx	lr
  60              	.LVL4:
  61              	.L5:
  89:../libs/max6650/src/max6650.c ****         case KScale_8: res = 8; break;
  62              		.loc 1 89 24 is_stmt 1 view .LVU8
  63              		.loc 1 89 33 view .LVU9
  64              		.loc 1 89 28 is_stmt 0 view .LVU10
  65 0016 0820     		movs	r0, #8
  66              	.LVL5:
  67              		.loc 1 89 9 view .LVU11
  68 0018 7047     		bx	lr
  69              	.LVL6:
  70              	.L3:
  90:../libs/max6650/src/max6650.c ****         case KScale_16: res = 16; break;
  71              		.loc 1 90 25 is_stmt 1 view .LVU12
  72              		.loc 1 90 35 view .LVU13
  73              		.loc 1 90 29 is_stmt 0 view .LVU14
  74 001a 1020     		movs	r0, #16
  75              	.LVL7:
  76              		.loc 1 90 9 view .LVU15
  77 001c 7047     		bx	lr
  78              	.LVL8:
  79              	.L8:
  86:../libs/max6650/src/max6650.c ****         case KScale_2: res = 2; break;
  80              		.loc 1 86 28 view .LVU16
  81 001e 0120     		movs	r0, #1
ARM GAS  C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s 			page 4


  82              	.LVL9:
  91:../libs/max6650/src/max6650.c ****         default: break;
  92:../libs/max6650/src/max6650.c ****     }
  93:../libs/max6650/src/max6650.c ****     return res;
  83              		.loc 1 93 5 is_stmt 1 view .LVU17
  94:../libs/max6650/src/max6650.c **** }
  84              		.loc 1 94 1 is_stmt 0 view .LVU18
  85 0020 7047     		bx	lr
  86              		.cfi_endproc
  87              	.LFE3:
  89              		.section	.rodata.MAX6650_Init.str1.4,"aMS",%progbits,1
  90              		.align	2
  91              	.LC0:
  92 0000 4D415836 		.ascii	"MAX6650: External I2C interface is not initialized!"
  92      3635303A 
  92      20457874 
  92      65726E61 
  92      6C204932 
  93 0033 0D00     		.ascii	"\015\000"
  94 0035 000000   		.align	2
  95              	.LC1:
  96 0038 4D415836 		.ascii	"MAX6650: no configuration available!\015\000"
  96      3635303A 
  96      206E6F20 
  96      636F6E66 
  96      69677572 
  97 005e 0000     		.align	2
  98              	.LC2:
  99 0060 4D415836 		.ascii	"MAX6650: I2C address configuration failed!\015\000"
  99      3635303A 
  99      20493243 
  99      20616464 
  99      72657373 
 100              		.section	.text.MAX6650_Init,"ax",%progbits
 101              		.align	1
 102              		.global	MAX6650_Init
 103              		.syntax unified
 104              		.thumb
 105              		.thumb_func
 106              		.fpu fpv4-sp-d16
 108              	MAX6650_Init:
 109              	.LVL10:
 110              	.LFB4:
  95:../libs/max6650/src/max6650.c **** 
  96:../libs/max6650/src/max6650.c **** bool MAX6650_Init(MAX6650_Config_t *max6650_config, const struct MAX6650_I2C_ExtInterface *ext_i2c_
  97:../libs/max6650/src/max6650.c **** {
 111              		.loc 1 97 1 is_stmt 1 view -0
 112              		.cfi_startproc
 113              		@ args = 0, pretend = 0, frame = 8
 114              		@ frame_needed = 0, uses_anonymous_args = 0
 115              		.loc 1 97 1 is_stmt 0 view .LVU20
 116 0000 10B5     		push	{r4, lr}
 117              	.LCFI0:
 118              		.cfi_def_cfa_offset 8
 119              		.cfi_offset 4, -8
 120              		.cfi_offset 14, -4
 121 0002 82B0     		sub	sp, sp, #8
ARM GAS  C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s 			page 5


 122              	.LCFI1:
 123              		.cfi_def_cfa_offset 16
  98:../libs/max6650/src/max6650.c ****     bool res;
 124              		.loc 1 98 5 is_stmt 1 view .LVU21
  99:../libs/max6650/src/max6650.c ****     uint8_t config_byte;
 125              		.loc 1 99 5 view .LVU22
 100:../libs/max6650/src/max6650.c ****     i2c_ext_if = ext_i2c_interface;
 126              		.loc 1 100 5 view .LVU23
 127              		.loc 1 100 16 is_stmt 0 view .LVU24
 128 0004 294B     		ldr	r3, .L23
 129 0006 1960     		str	r1, [r3]
 101:../libs/max6650/src/max6650.c ****     config = max6650_config;
 130              		.loc 1 101 5 is_stmt 1 view .LVU25
 131              		.loc 1 101 12 is_stmt 0 view .LVU26
 132 0008 294B     		ldr	r3, .L23+4
 133 000a 1860     		str	r0, [r3]
 102:../libs/max6650/src/max6650.c **** 
 103:../libs/max6650/src/max6650.c ****     if(i2c_ext_if == NULL)
 134              		.loc 1 103 5 is_stmt 1 view .LVU27
 135              		.loc 1 103 7 is_stmt 0 view .LVU28
 136 000c 39B1     		cbz	r1, .L21
 104:../libs/max6650/src/max6650.c ****     {
 105:../libs/max6650/src/max6650.c ****         printf("MAX6650: External I2C interface is not initialized!\r\n");
 106:../libs/max6650/src/max6650.c ****         return false;
 107:../libs/max6650/src/max6650.c ****     }
 108:../libs/max6650/src/max6650.c **** 
 109:../libs/max6650/src/max6650.c ****     if(config == NULL)
 137              		.loc 1 109 5 is_stmt 1 view .LVU29
 138              		.loc 1 109 7 is_stmt 0 view .LVU30
 139 000e 58B1     		cbz	r0, .L22
 110:../libs/max6650/src/max6650.c ****     {
 111:../libs/max6650/src/max6650.c ****         printf("MAX6650: no configuration available!\r\n");
 112:../libs/max6650/src/max6650.c ****         return false;
 113:../libs/max6650/src/max6650.c ****     }
 114:../libs/max6650/src/max6650.c **** 
 115:../libs/max6650/src/max6650.c ****     switch(config->add_line_connection)
 140              		.loc 1 115 5 is_stmt 1 view .LVU31
 141              		.loc 1 115 18 is_stmt 0 view .LVU32
 142 0010 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
 143              		.loc 1 115 5 view .LVU33
 144 0012 032B     		cmp	r3, #3
 145 0014 44D8     		bhi	.L13
 146 0016 DFE803F0 		tbb	[pc, r3]
 147              	.L15:
 148 001a 0C       		.byte	(.L18-.L15)/2
 149 001b 37       		.byte	(.L17-.L15)/2
 150 001c 3B       		.byte	(.L16-.L15)/2
 151 001d 3F       		.byte	(.L14-.L15)/2
 152              		.p2align 1
 153              	.L21:
 105:../libs/max6650/src/max6650.c ****         return false;
 154              		.loc 1 105 9 is_stmt 1 view .LVU34
 155 001e 2548     		ldr	r0, .L23+8
 156              	.LVL11:
 105:../libs/max6650/src/max6650.c ****         return false;
 157              		.loc 1 105 9 is_stmt 0 view .LVU35
 158 0020 FFF7FEFF 		bl	puts
ARM GAS  C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s 			page 6


 159              	.LVL12:
 106:../libs/max6650/src/max6650.c ****     }
 160              		.loc 1 106 9 is_stmt 1 view .LVU36
 106:../libs/max6650/src/max6650.c ****     }
 161              		.loc 1 106 16 is_stmt 0 view .LVU37
 162 0024 0020     		movs	r0, #0
 163 0026 2DE0     		b	.L11
 164              	.LVL13:
 165              	.L22:
 111:../libs/max6650/src/max6650.c ****         return false;
 166              		.loc 1 111 9 is_stmt 1 view .LVU38
 167 0028 2348     		ldr	r0, .L23+12
 168              	.LVL14:
 111:../libs/max6650/src/max6650.c ****         return false;
 169              		.loc 1 111 9 is_stmt 0 view .LVU39
 170 002a FFF7FEFF 		bl	puts
 171              	.LVL15:
 112:../libs/max6650/src/max6650.c ****     }
 172              		.loc 1 112 9 is_stmt 1 view .LVU40
 112:../libs/max6650/src/max6650.c ****     }
 173              		.loc 1 112 16 is_stmt 0 view .LVU41
 174 002e 0020     		movs	r0, #0
 175 0030 28E0     		b	.L11
 176              	.LVL16:
 177              	.L18:
 116:../libs/max6650/src/max6650.c ****     {
 117:../libs/max6650/src/max6650.c ****         case ADD_Line_GND:
 118:../libs/max6650/src/max6650.c ****             i2c_address = I2C_ADDRESS_GND;
 178              		.loc 1 118 13 is_stmt 1 view .LVU42
 179              		.loc 1 118 25 is_stmt 0 view .LVU43
 180 0032 224B     		ldr	r3, .L23+16
 181 0034 9022     		movs	r2, #144
 182 0036 1A70     		strb	r2, [r3]
 119:../libs/max6650/src/max6650.c ****             break;
 183              		.loc 1 119 13 is_stmt 1 view .LVU44
 184              	.L19:
 120:../libs/max6650/src/max6650.c ****         case ADD_Line_Vcc:
 121:../libs/max6650/src/max6650.c ****             i2c_address = I2C_ADDRESS_VCC;
 122:../libs/max6650/src/max6650.c ****             break;
 123:../libs/max6650/src/max6650.c ****         case ADD_Line_NotConnected:
 124:../libs/max6650/src/max6650.c ****             i2c_address = I2C_ADDRESS_NOT_CONNECTED;
 125:../libs/max6650/src/max6650.c ****             break;
 126:../libs/max6650/src/max6650.c ****         case ADD_Line_Res10K:
 127:../libs/max6650/src/max6650.c ****             i2c_address = I2C_ADDRESS_RES10K;
 128:../libs/max6650/src/max6650.c ****             break;
 129:../libs/max6650/src/max6650.c ****         default:
 130:../libs/max6650/src/max6650.c ****             printf("MAX6650: I2C address configuration failed!\r\n");
 131:../libs/max6650/src/max6650.c ****             return false;
 132:../libs/max6650/src/max6650.c ****     }
 133:../libs/max6650/src/max6650.c **** 
 134:../libs/max6650/src/max6650.c ****     config_byte = (config->operating_mode&0x03)<<4 | (config->fan_lovtage&0x01)<<3 | (config->k_sca
 185              		.loc 1 134 5 view .LVU45
 186              		.loc 1 134 26 is_stmt 0 view .LVU46
 187 0038 4378     		ldrb	r3, [r0, #1]	@ zero_extendqisi2
 188              		.loc 1 134 48 view .LVU47
 189 003a 1B01     		lsls	r3, r3, #4
 190 003c 03F03003 		and	r3, r3, #48
ARM GAS  C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s 			page 7


 191              		.loc 1 134 61 view .LVU48
 192 0040 8278     		ldrb	r2, [r0, #2]	@ zero_extendqisi2
 193              		.loc 1 134 80 view .LVU49
 194 0042 D200     		lsls	r2, r2, #3
 195 0044 02F00802 		and	r2, r2, #8
 196              		.loc 1 134 52 view .LVU50
 197 0048 1343     		orrs	r3, r3, r2
 198              		.loc 1 134 93 view .LVU51
 199 004a 90F90320 		ldrsb	r2, [r0, #3]
 200              		.loc 1 134 102 view .LVU52
 201 004e 02F00702 		and	r2, r2, #7
 202              		.loc 1 134 84 view .LVU53
 203 0052 1343     		orrs	r3, r3, r2
 204              		.loc 1 134 17 view .LVU54
 205 0054 8DF80730 		strb	r3, [sp, #7]
 135:../libs/max6650/src/max6650.c **** 
 136:../libs/max6650/src/max6650.c ****     res = i2c_ext_if->i2c_write(i2c_address, MAX6650_CONFIG_REG, &config_byte, 1);
 206              		.loc 1 136 5 is_stmt 1 view .LVU55
 207              		.loc 1 136 21 is_stmt 0 view .LVU56
 208 0058 8C68     		ldr	r4, [r1, #8]
 209              		.loc 1 136 11 view .LVU57
 210 005a 0123     		movs	r3, #1
 211 005c 0DF10702 		add	r2, sp, #7
 212 0060 0221     		movs	r1, #2
 213              	.LVL17:
 214              		.loc 1 136 11 view .LVU58
 215 0062 1648     		ldr	r0, .L23+16
 216              	.LVL18:
 217              		.loc 1 136 11 view .LVU59
 218 0064 0078     		ldrb	r0, [r0]	@ zero_extendqisi2
 219 0066 A047     		blx	r4
 220              	.LVL19:
 137:../libs/max6650/src/max6650.c **** 
 138:../libs/max6650/src/max6650.c ****     if(res == true)
 221              		.loc 1 138 5 is_stmt 1 view .LVU60
 222              		.loc 1 138 7 is_stmt 0 view .LVU61
 223 0068 60B1     		cbz	r0, .L11
 139:../libs/max6650/src/max6650.c ****     {
 140:../libs/max6650/src/max6650.c ****         config_byte = COUNTT;
 224              		.loc 1 140 9 is_stmt 1 view .LVU62
 225              		.loc 1 140 21 is_stmt 0 view .LVU63
 226 006a 0223     		movs	r3, #2
 227 006c 8DF80730 		strb	r3, [sp, #7]
 141:../libs/max6650/src/max6650.c ****         res = i2c_ext_if->i2c_write(i2c_address, MAX6650_COUNT_REG, &config_byte, 1);
 228              		.loc 1 141 9 is_stmt 1 view .LVU64
 229              		.loc 1 141 25 is_stmt 0 view .LVU65
 230 0070 0E4B     		ldr	r3, .L23
 231 0072 1B68     		ldr	r3, [r3]
 232 0074 9C68     		ldr	r4, [r3, #8]
 233              		.loc 1 141 15 view .LVU66
 234 0076 0123     		movs	r3, #1
 235 0078 0DF10702 		add	r2, sp, #7
 236 007c 1621     		movs	r1, #22
 237 007e 0F48     		ldr	r0, .L23+16
 238              	.LVL20:
 239              		.loc 1 141 15 view .LVU67
 240 0080 0078     		ldrb	r0, [r0]	@ zero_extendqisi2
ARM GAS  C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s 			page 8


 241 0082 A047     		blx	r4
 242              	.LVL21:
 243              	.L11:
 142:../libs/max6650/src/max6650.c ****     }
 143:../libs/max6650/src/max6650.c **** 
 144:../libs/max6650/src/max6650.c ****     return res;
 145:../libs/max6650/src/max6650.c **** }
 244              		.loc 1 145 1 view .LVU68
 245 0084 02B0     		add	sp, sp, #8
 246              	.LCFI2:
 247              		.cfi_remember_state
 248              		.cfi_def_cfa_offset 8
 249              		@ sp needed
 250 0086 10BD     		pop	{r4, pc}
 251              	.LVL22:
 252              	.L17:
 253              	.LCFI3:
 254              		.cfi_restore_state
 121:../libs/max6650/src/max6650.c ****             break;
 255              		.loc 1 121 13 is_stmt 1 view .LVU69
 121:../libs/max6650/src/max6650.c ****             break;
 256              		.loc 1 121 25 is_stmt 0 view .LVU70
 257 0088 0C4B     		ldr	r3, .L23+16
 258 008a 9622     		movs	r2, #150
 259 008c 1A70     		strb	r2, [r3]
 122:../libs/max6650/src/max6650.c ****         case ADD_Line_NotConnected:
 260              		.loc 1 122 13 is_stmt 1 view .LVU71
 261 008e D3E7     		b	.L19
 262              	.L16:
 124:../libs/max6650/src/max6650.c ****             break;
 263              		.loc 1 124 13 view .LVU72
 124:../libs/max6650/src/max6650.c ****             break;
 264              		.loc 1 124 25 is_stmt 0 view .LVU73
 265 0090 0A4B     		ldr	r3, .L23+16
 266 0092 3622     		movs	r2, #54
 267 0094 1A70     		strb	r2, [r3]
 125:../libs/max6650/src/max6650.c ****         case ADD_Line_Res10K:
 268              		.loc 1 125 13 is_stmt 1 view .LVU74
 269 0096 CFE7     		b	.L19
 270              	.L14:
 127:../libs/max6650/src/max6650.c ****             break;
 271              		.loc 1 127 13 view .LVU75
 127:../libs/max6650/src/max6650.c ****             break;
 272              		.loc 1 127 25 is_stmt 0 view .LVU76
 273 0098 084B     		ldr	r3, .L23+16
 274 009a 3E22     		movs	r2, #62
 275 009c 1A70     		strb	r2, [r3]
 128:../libs/max6650/src/max6650.c ****         default:
 276              		.loc 1 128 13 is_stmt 1 view .LVU77
 277 009e CBE7     		b	.L19
 278              	.L13:
 130:../libs/max6650/src/max6650.c ****             return false;
 279              		.loc 1 130 13 view .LVU78
 280 00a0 0748     		ldr	r0, .L23+20
 281              	.LVL23:
 130:../libs/max6650/src/max6650.c ****             return false;
 282              		.loc 1 130 13 is_stmt 0 view .LVU79
ARM GAS  C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s 			page 9


 283 00a2 FFF7FEFF 		bl	puts
 284              	.LVL24:
 131:../libs/max6650/src/max6650.c ****     }
 285              		.loc 1 131 13 is_stmt 1 view .LVU80
 131:../libs/max6650/src/max6650.c ****     }
 286              		.loc 1 131 20 is_stmt 0 view .LVU81
 287 00a6 0020     		movs	r0, #0
 288 00a8 ECE7     		b	.L11
 289              	.L24:
 290 00aa 00BF     		.align	2
 291              	.L23:
 292 00ac 00000000 		.word	.LANCHOR0
 293 00b0 00000000 		.word	.LANCHOR1
 294 00b4 00000000 		.word	.LC0
 295 00b8 38000000 		.word	.LC1
 296 00bc 00000000 		.word	.LANCHOR2
 297 00c0 60000000 		.word	.LC2
 298              		.cfi_endproc
 299              	.LFE4:
 301              		.section	.text.MAX6650_GetSpeed,"ax",%progbits
 302              		.align	1
 303              		.global	MAX6650_GetSpeed
 304              		.syntax unified
 305              		.thumb
 306              		.thumb_func
 307              		.fpu fpv4-sp-d16
 309              	MAX6650_GetSpeed:
 310              	.LVL25:
 311              	.LFB5:
 146:../libs/max6650/src/max6650.c **** 
 147:../libs/max6650/src/max6650.c **** 
 148:../libs/max6650/src/max6650.c **** bool MAX6650_GetSpeed(uint8_t *speed)
 149:../libs/max6650/src/max6650.c **** {
 312              		.loc 1 149 1 is_stmt 1 view -0
 313              		.cfi_startproc
 314              		@ args = 0, pretend = 0, frame = 8
 315              		@ frame_needed = 0, uses_anonymous_args = 0
 316              		.loc 1 149 1 is_stmt 0 view .LVU83
 317 0000 30B5     		push	{r4, r5, lr}
 318              	.LCFI4:
 319              		.cfi_def_cfa_offset 12
 320              		.cfi_offset 4, -12
 321              		.cfi_offset 5, -8
 322              		.cfi_offset 14, -4
 323 0002 83B0     		sub	sp, sp, #12
 324              	.LCFI5:
 325              		.cfi_def_cfa_offset 24
 326 0004 0446     		mov	r4, r0
 150:../libs/max6650/src/max6650.c ****     uint8_t rps;
 327              		.loc 1 150 5 is_stmt 1 view .LVU84
 151:../libs/max6650/src/max6650.c ****     bool res;
 328              		.loc 1 151 5 view .LVU85
 152:../libs/max6650/src/max6650.c **** 
 153:../libs/max6650/src/max6650.c ****     res = i2c_ext_if->i2c_read(i2c_address, MAX6650_TACHO_0_REG, &rps, 1);
 329              		.loc 1 153 5 view .LVU86
 330              		.loc 1 153 21 is_stmt 0 view .LVU87
 331 0006 0E4B     		ldr	r3, .L28
ARM GAS  C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s 			page 10


 332 0008 1B68     		ldr	r3, [r3]
 333 000a 5D68     		ldr	r5, [r3, #4]
 334              		.loc 1 153 11 view .LVU88
 335 000c 0123     		movs	r3, #1
 336 000e 0DF10702 		add	r2, sp, #7
 337 0012 0C21     		movs	r1, #12
 338 0014 0B48     		ldr	r0, .L28+4
 339              	.LVL26:
 340              		.loc 1 153 11 view .LVU89
 341 0016 0078     		ldrb	r0, [r0]	@ zero_extendqisi2
 342 0018 A847     		blx	r5
 343              	.LVL27:
 154:../libs/max6650/src/max6650.c **** 
 155:../libs/max6650/src/max6650.c ****     if(res == true)
 344              		.loc 1 155 5 is_stmt 1 view .LVU90
 345              		.loc 1 155 7 is_stmt 0 view .LVU91
 346 001a 70B1     		cbz	r0, .L26
 156:../libs/max6650/src/max6650.c ****     {
 157:../libs/max6650/src/max6650.c ****         rps = ((rps /2)/COUNTT);
 347              		.loc 1 157 9 is_stmt 1 view .LVU92
 348              		.loc 1 157 13 is_stmt 0 view .LVU93
 349 001c 9DF80730 		ldrb	r3, [sp, #7]	@ zero_extendqisi2
 350 0020 9B08     		lsrs	r3, r3, #2
 351 0022 8DF80730 		strb	r3, [sp, #7]
 158:../libs/max6650/src/max6650.c ****         *speed =  (uint32_t)rps * 60 * 100 / config->rpm_max;
 352              		.loc 1 158 9 is_stmt 1 view .LVU94
 353              		.loc 1 158 38 is_stmt 0 view .LVU95
 354 0026 41F27072 		movw	r2, #6000
 355 002a 02FB03F3 		mul	r3, r2, r3
 356              		.loc 1 158 52 view .LVU96
 357 002e 064A     		ldr	r2, .L28+8
 358 0030 1268     		ldr	r2, [r2]
 359 0032 9288     		ldrh	r2, [r2, #4]
 360              		.loc 1 158 44 view .LVU97
 361 0034 B3FBF2F3 		udiv	r3, r3, r2
 362              		.loc 1 158 16 view .LVU98
 363 0038 2370     		strb	r3, [r4]
 364              	.L26:
 159:../libs/max6650/src/max6650.c ****     }
 160:../libs/max6650/src/max6650.c **** 
 161:../libs/max6650/src/max6650.c ****    return true;
 365              		.loc 1 161 4 is_stmt 1 view .LVU99
 162:../libs/max6650/src/max6650.c **** }
 366              		.loc 1 162 1 is_stmt 0 view .LVU100
 367 003a 0120     		movs	r0, #1
 368              	.LVL28:
 369              		.loc 1 162 1 view .LVU101
 370 003c 03B0     		add	sp, sp, #12
 371              	.LCFI6:
 372              		.cfi_def_cfa_offset 12
 373              		@ sp needed
 374 003e 30BD     		pop	{r4, r5, pc}
 375              	.LVL29:
 376              	.L29:
 377              		.loc 1 162 1 view .LVU102
 378              		.align	2
 379              	.L28:
ARM GAS  C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s 			page 11


 380 0040 00000000 		.word	.LANCHOR0
 381 0044 00000000 		.word	.LANCHOR2
 382 0048 00000000 		.word	.LANCHOR1
 383              		.cfi_endproc
 384              	.LFE5:
 386              		.section	.rodata.MAX6650_SetSpeed.str1.4,"aMS",%progbits,1
 387              		.align	2
 388              	.LC3:
 389 0000 4D415836 		.ascii	"MAX6650: Warning, speed should be in range: 0..100%"
 389      3635303A 
 389      20576172 
 389      6E696E67 
 389      2C207370 
 390 0033 250D0A00 		.ascii	"%\015\012\000"
 391              		.section	.text.MAX6650_SetSpeed,"ax",%progbits
 392              		.align	1
 393              		.global	MAX6650_SetSpeed
 394              		.syntax unified
 395              		.thumb
 396              		.thumb_func
 397              		.fpu fpv4-sp-d16
 399              	MAX6650_SetSpeed:
 400              	.LVL30:
 401              	.LFB6:
 163:../libs/max6650/src/max6650.c **** 
 164:../libs/max6650/src/max6650.c **** 
 165:../libs/max6650/src/max6650.c **** bool MAX6650_SetSpeed(uint8_t speed_set, uint8_t *speed_actual)
 166:../libs/max6650/src/max6650.c **** {
 402              		.loc 1 166 1 is_stmt 1 view -0
 403              		.cfi_startproc
 404              		@ args = 0, pretend = 0, frame = 8
 405              		@ frame_needed = 0, uses_anonymous_args = 0
 406              		.loc 1 166 1 is_stmt 0 view .LVU104
 407 0000 30B5     		push	{r4, r5, lr}
 408              	.LCFI7:
 409              		.cfi_def_cfa_offset 12
 410              		.cfi_offset 4, -12
 411              		.cfi_offset 5, -8
 412              		.cfi_offset 14, -4
 413 0002 83B0     		sub	sp, sp, #12
 414              	.LCFI8:
 415              		.cfi_def_cfa_offset 24
 416 0004 0D46     		mov	r5, r1
 167:../libs/max6650/src/max6650.c ****     uint8_t ktach;
 417              		.loc 1 167 5 is_stmt 1 view .LVU105
 168:../libs/max6650/src/max6650.c ****     uint16_t rpm;
 418              		.loc 1 168 5 view .LVU106
 169:../libs/max6650/src/max6650.c ****     bool res;
 419              		.loc 1 169 5 view .LVU107
 170:../libs/max6650/src/max6650.c **** 
 171:../libs/max6650/src/max6650.c ****     if(speed_set > 100)
 420              		.loc 1 171 5 view .LVU108
 421              		.loc 1 171 7 is_stmt 0 view .LVU109
 422 0006 6428     		cmp	r0, #100
 423 0008 25D8     		bhi	.L34
 424              	.LVL31:
 425              	.L31:
ARM GAS  C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s 			page 12


 172:../libs/max6650/src/max6650.c ****     {
 173:../libs/max6650/src/max6650.c ****         printf("MAX6650: Warning, speed should be in range: 0..100%%\r\n");
 174:../libs/max6650/src/max6650.c ****         speed_set = 100;
 175:../libs/max6650/src/max6650.c ****     }
 176:../libs/max6650/src/max6650.c **** 
 177:../libs/max6650/src/max6650.c ****     rpm = config->rpm_max/100 * speed_set;
 426              		.loc 1 177 5 is_stmt 1 view .LVU110
 427              		.loc 1 177 17 is_stmt 0 view .LVU111
 428 000a 174B     		ldr	r3, .L36
 429 000c 1B68     		ldr	r3, [r3]
 430 000e 9C88     		ldrh	r4, [r3, #4]
 431              		.loc 1 177 31 view .LVU112
 432 0010 164A     		ldr	r2, .L36+4
 433 0012 A2FB0424 		umull	r2, r4, r2, r4
 434 0016 6409     		lsrs	r4, r4, #5
 435              		.loc 1 177 9 view .LVU113
 436 0018 04FB00F0 		mul	r0, r4, r0
 437              	.LVL32:
 438              		.loc 1 177 9 view .LVU114
 439 001c 84B2     		uxth	r4, r0
 440              	.LVL33:
 178:../libs/max6650/src/max6650.c **** 
 179:../libs/max6650/src/max6650.c ****     ktach=(((992 * get_scale(config->k_scale)) / (rpm/60) ) - 1);
 441              		.loc 1 179 5 is_stmt 1 view .LVU115
 442              		.loc 1 179 20 is_stmt 0 view .LVU116
 443 001e D878     		ldrb	r0, [r3, #3]	@ zero_extendqisi2
 444 0020 FFF7FEFF 		bl	get_scale
 445              	.LVL34:
 446              		.loc 1 179 18 view .LVU117
 447 0024 C0EB4010 		rsb	r0, r0, r0, lsl #5
 448 0028 4001     		lsls	r0, r0, #5
 449              		.loc 1 179 54 view .LVU118
 450 002a 114B     		ldr	r3, .L36+8
 451 002c A3FB0434 		umull	r3, r4, r3, r4
 452              	.LVL35:
 453              		.loc 1 179 54 view .LVU119
 454 0030 6409     		lsrs	r4, r4, #5
 455              		.loc 1 179 48 view .LVU120
 456 0032 90FBF4F4 		sdiv	r4, r0, r4
 457              		.loc 1 179 61 view .LVU121
 458 0036 013C     		subs	r4, r4, #1
 459              		.loc 1 179 10 view .LVU122
 460 0038 8DF80740 		strb	r4, [sp, #7]
 180:../libs/max6650/src/max6650.c **** 
 181:../libs/max6650/src/max6650.c ****     res = i2c_ext_if->i2c_write(i2c_address, MAX6650_SPEED_REG, &ktach, 1);
 461              		.loc 1 181 5 is_stmt 1 view .LVU123
 462              		.loc 1 181 21 is_stmt 0 view .LVU124
 463 003c 0D4B     		ldr	r3, .L36+12
 464 003e 1B68     		ldr	r3, [r3]
 465 0040 9C68     		ldr	r4, [r3, #8]
 466              		.loc 1 181 11 view .LVU125
 467 0042 0123     		movs	r3, #1
 468 0044 0DF10702 		add	r2, sp, #7
 469 0048 0021     		movs	r1, #0
 470 004a 0B48     		ldr	r0, .L36+16
 471 004c 0078     		ldrb	r0, [r0]	@ zero_extendqisi2
 472 004e A047     		blx	r4
ARM GAS  C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s 			page 13


 473              	.LVL36:
 182:../libs/max6650/src/max6650.c **** 
 183:../libs/max6650/src/max6650.c ****     if(res == true)
 474              		.loc 1 183 5 is_stmt 1 view .LVU126
 475              		.loc 1 183 7 is_stmt 0 view .LVU127
 476 0050 30B9     		cbnz	r0, .L35
 477              	.L32:
 184:../libs/max6650/src/max6650.c ****     {
 185:../libs/max6650/src/max6650.c ****         res = MAX6650_GetSpeed(speed_actual);
 186:../libs/max6650/src/max6650.c ****     }
 187:../libs/max6650/src/max6650.c **** 
 188:../libs/max6650/src/max6650.c ****     return res;
 478              		.loc 1 188 5 is_stmt 1 view .LVU128
 189:../libs/max6650/src/max6650.c **** }
 479              		.loc 1 189 1 is_stmt 0 view .LVU129
 480 0052 03B0     		add	sp, sp, #12
 481              	.LCFI9:
 482              		.cfi_remember_state
 483              		.cfi_def_cfa_offset 12
 484              		@ sp needed
 485 0054 30BD     		pop	{r4, r5, pc}
 486              	.LVL37:
 487              	.L34:
 488              	.LCFI10:
 489              		.cfi_restore_state
 173:../libs/max6650/src/max6650.c ****         speed_set = 100;
 490              		.loc 1 173 9 is_stmt 1 view .LVU130
 491 0056 0948     		ldr	r0, .L36+20
 492              	.LVL38:
 173:../libs/max6650/src/max6650.c ****         speed_set = 100;
 493              		.loc 1 173 9 is_stmt 0 view .LVU131
 494 0058 FFF7FEFF 		bl	printf
 495              	.LVL39:
 174:../libs/max6650/src/max6650.c ****     }
 496              		.loc 1 174 9 is_stmt 1 view .LVU132
 174:../libs/max6650/src/max6650.c ****     }
 497              		.loc 1 174 19 is_stmt 0 view .LVU133
 498 005c 6420     		movs	r0, #100
 499 005e D4E7     		b	.L31
 500              	.LVL40:
 501              	.L35:
 185:../libs/max6650/src/max6650.c ****     }
 502              		.loc 1 185 9 is_stmt 1 view .LVU134
 185:../libs/max6650/src/max6650.c ****     }
 503              		.loc 1 185 15 is_stmt 0 view .LVU135
 504 0060 2846     		mov	r0, r5
 505              	.LVL41:
 185:../libs/max6650/src/max6650.c ****     }
 506              		.loc 1 185 15 view .LVU136
 507 0062 FFF7FEFF 		bl	MAX6650_GetSpeed
 508              	.LVL42:
 185:../libs/max6650/src/max6650.c ****     }
 509              		.loc 1 185 15 view .LVU137
 510 0066 F4E7     		b	.L32
 511              	.L37:
 512              		.align	2
 513              	.L36:
ARM GAS  C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s 			page 14


 514 0068 00000000 		.word	.LANCHOR1
 515 006c 1F85EB51 		.word	1374389535
 516 0070 89888888 		.word	-2004318071
 517 0074 00000000 		.word	.LANCHOR0
 518 0078 00000000 		.word	.LANCHOR2
 519 007c 00000000 		.word	.LC3
 520              		.cfi_endproc
 521              	.LFE6:
 523              		.section	.bss.config,"aw",%nobits
 524              		.align	2
 525              		.set	.LANCHOR1,. + 0
 528              	config:
 529 0000 00000000 		.space	4
 530              		.section	.bss.i2c_address,"aw",%nobits
 531              		.set	.LANCHOR2,. + 0
 534              	i2c_address:
 535 0000 00       		.space	1
 536              		.section	.bss.i2c_ext_if,"aw",%nobits
 537              		.align	2
 538              		.set	.LANCHOR0,. + 0
 541              	i2c_ext_if:
 542 0000 00000000 		.space	4
 543              		.text
 544              	.Letext0:
 545              		.file 2 "c:\\gnu arm embedded toolchain\\10 2021.07\\arm-none-eabi\\include\\machine\\_default_typ
 546              		.file 3 "c:\\gnu arm embedded toolchain\\10 2021.07\\arm-none-eabi\\include\\sys\\_stdint.h"
 547              		.file 4 "c:\\gnu arm embedded toolchain\\10 2021.07\\arm-none-eabi\\include\\sys\\types.h"
 548              		.file 5 "../libs/max6650/inc/max6650.h"
 549              		.file 6 "c:\\gnu arm embedded toolchain\\10 2021.07\\arm-none-eabi\\include\\stdio.h"
 550              		.file 7 "<built-in>"
ARM GAS  C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s 			page 15


DEFINED SYMBOLS
                            *ABS*:00000000 max6650.c
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:18     .text.get_scale:00000000 $t
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:25     .text.get_scale:00000000 get_scale
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:40     .text.get_scale:00000008 $d
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:90     .rodata.MAX6650_Init.str1.4:00000000 $d
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:101    .text.MAX6650_Init:00000000 $t
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:108    .text.MAX6650_Init:00000000 MAX6650_Init
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:148    .text.MAX6650_Init:0000001a $d
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:152    .text.MAX6650_Init:0000001e $t
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:292    .text.MAX6650_Init:000000ac $d
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:302    .text.MAX6650_GetSpeed:00000000 $t
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:309    .text.MAX6650_GetSpeed:00000000 MAX6650_GetSpeed
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:380    .text.MAX6650_GetSpeed:00000040 $d
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:387    .rodata.MAX6650_SetSpeed.str1.4:00000000 $d
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:392    .text.MAX6650_SetSpeed:00000000 $t
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:399    .text.MAX6650_SetSpeed:00000000 MAX6650_SetSpeed
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:514    .text.MAX6650_SetSpeed:00000068 $d
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:524    .bss.config:00000000 $d
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:528    .bss.config:00000000 config
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:534    .bss.i2c_address:00000000 i2c_address
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:535    .bss.i2c_address:00000000 $d
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:537    .bss.i2c_ext_if:00000000 $d
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:541    .bss.i2c_ext_if:00000000 i2c_ext_if
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:45     .text.get_scale:0000000d $d
C:\Users\mikal\AppData\Local\Temp\cckMNh0I.s:45     .text.get_scale:0000000e $t

UNDEFINED SYMBOLS
puts
printf
